<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿«é€Ÿè¯Šæ–­</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .status { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        pre { background: #f1f3f4; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 10px 0; }
        .step { counter-increment: step; }
        .step::before { content: counter(step) ". "; font-weight: bold; color: #007bff; }
    </style>
</head>
<body>
    <h1>ğŸš¨ åšå®¢æ–‡ç« æ˜¾ç¤ºé—®é¢˜å¿«é€Ÿè¯Šæ–­</h1>
    
    <div class="card">
        <h3>ğŸ“‹ æœ€å¯èƒ½çš„åŸå› æ£€æŸ¥æ¸…å•ï¼š</h3>
        <ol style="counter-reset: step;">
            <li class="step">Netlifyç¯å¢ƒå˜é‡æœªè®¾ç½®</li>
            <li class="step">Netlifyæœªè‡ªåŠ¨éƒ¨ç½²æœ€æ–°ä»£ç </li>
            <li class="step">æµè§ˆå™¨ç¼“å­˜é—®é¢˜</li>
            <li class="step">Supabaseè¿æ¥æƒé™é—®é¢˜</li>
        </ol>
    </div>

    <div class="card warning">
        <h3>âš¡ ç«‹å³å°è¯•çš„è§£å†³æ–¹æ¡ˆï¼š</h3>
        <p><strong>1. åœ¨Netlifyè®¾ç½®ç¯å¢ƒå˜é‡ï¼š</strong></p>
        <pre>
VITE_SUPABASE_URL=https://talufbfkwrdrpwbzurcu.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRhbHVmYmZrd3JkcnB3Ynp1cmN1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNjMxODUsImV4cCI6MjA3ODkzOTE4NX0.tpBu2CSiKJo0Z-YjPcF2Oey8qyhPlinuzJA6Ld8CTo0
        </pre>
        
        <p><strong>2. æ‰‹åŠ¨è§¦å‘Netlifyéƒ¨ç½²ï¼š</strong></p>
        <ul>
            <li>è¿›å…¥Netlifyæ§åˆ¶å°</li>
            <li>é€‰æ‹©ä½ çš„ç«™ç‚¹</li>
            <li>ç‚¹å‡» "Deploys" â†’ "Trigger deploy"</li>
            <li>é€‰æ‹© "Deploy branch"</li>
        </ul>
        
        <p><strong>3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼š</strong></p>
        <ul>
            <li>æŒ‰ Ctrl+F5 å¼ºåˆ¶åˆ·æ–°</li>
            <li>æˆ–æŒ‰ F12 â†’ Network â†’ å‹¾é€‰ "Disable cache"</li>
        </ul>
    </div>

    <div class="card">
        <h3>ğŸ” å®æ—¶æµ‹è¯• Supabase è¿æ¥ï¼š</h3>
        <button onclick="testDirectConnection()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
            ğŸ§ª ç›´æ¥æµ‹è¯•è¿æ¥
        </button>
        <div id="testResult"></div>
    </div>

    <div class="card">
        <h3>ğŸ“± å¦‚æœä»ç„¶æ²¡æœ‰å†…å®¹ï¼š</h3>
        <p>è¯·å‘Šè¯‰æˆ‘ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
        <ul>
            <li>Netlifyç«™ç‚¹çš„å…·ä½“URL</li>
            <li>æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯ï¼ˆæŒ‰F12æŸ¥çœ‹ï¼‰</li>
            <li>æ˜¯å¦å·²ç»è®¾ç½®äº†ç¯å¢ƒå˜é‡</li>
            <li>Netlifyéƒ¨ç½²æ˜¯å¦æˆåŠŸ</li>
        </ul>
    </div>

    <script>
        window.testDirectConnection = async function() {
            const result = document.getElementById('testResult')
            result.innerHTML = '<p>ğŸ”„ æµ‹è¯•ä¸­...</p>'
            
            try {
                const response = await fetch('https://talufbfkwrdrpwbzurcu.supabase.co/rest/v1/articles?select=*&is_published=true', {
                    headers: {
                        'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRhbHVmYmZrd3JkcnB3Ynp1cmN1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNjMxODUsImV4cCI6MjA3ODkzOTE4NX0.tpBu2CSiKJo0Z-YjPcF2Oey8qyhPlinuzJA6Ld8CTo0',
                        'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRhbHVmYmZrd3JkcnB3Ynp1cmN1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNjMxODUsImV4cCI6MjA3ODkzOTE4NX0.tpBu2CSiKJo0Z-YjPcF2Oey8qyhPlinuzJA6Ld8CTo0'
                    }
                })
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`)
                }
                
                const data = await response.json()
                
                result.innerHTML = `
                    <div class="success">
                        <h4>âœ… è¿æ¥æˆåŠŸï¼æ‰¾åˆ° ${data.length} ç¯‡æ–‡ç« </h4>
                        <pre>${JSON.stringify(data.slice(0, 2), null, 2)}</pre>
                        <p>å¦‚æœè¿™é‡Œèƒ½çœ‹åˆ°æ•°æ®ï¼Œè¯´æ˜æ•°æ®åº“è¿æ¥æ­£å¸¸ï¼Œé—®é¢˜åœ¨äºVueåº”ç”¨çš„ç¯å¢ƒå˜é‡é…ç½®ã€‚</p>
                    </div>
                `
            } catch (error) {
                result.innerHTML = `
                    <div class="error">
                        <h4>âŒ è¿æ¥å¤±è´¥</h4>
                        <p><strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> ${error.message}</p>
                        <p>è¿™å¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜æˆ–CORSé™åˆ¶ï¼Œä½†æ•°æ®åº“æœ¬èº«æ˜¯æ­£å¸¸çš„ã€‚</p>
                    </div>
                `
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•
        setTimeout(testDirectConnection, 1000)
    </script>
</body>
</html>